require! {
  nightmare: Nightmare
  'nightmare-download-manager'
}

nightmare-download-manager Nightmare

files = <[
  http://tstorage.info/b7gopfgbb2se
  http://tstorage.info/bby1q1oa7yd4
  http://tstorage.info/bk2oufo8qs17
  http://tstorage.info/bpsgenj0dm02
  http://tstorage.info/bzrz1fdpk1u1
  http://tstorage.info/c7ahw7a6cnme
  http://tstorage.info/cawuxlg0i189
  http://tstorage.info/cdgv0zibd17o
  http://tstorage.info/cgwlyhk9q5n7
  http://tstorage.info/cnm8t67rylhb
  http://tstorage.info/cpv20bhs4c6u
  http://tstorage.info/crinoe7h0y8a
  http://tstorage.info/cy5r99ffeqgi
  http://tstorage.info/d146hffx40xw
  http://tstorage.info/d2ob8c8ye6i7
  http://tstorage.info/d4e6pr6vaus3
  http://tstorage.info/d6v4z3w4i9h6
  http://tstorage.info/dfpvijkqxsda
  http://tstorage.info/dgsx2mfsurt5
  http://tstorage.info/dhnd9lpm2drr
  http://tstorage.info/do550jyuhpmn
  http://tstorage.info/do550jyuhpmn.
  http://tstorage.info/dqu6qmjeau9o
  http://tstorage.info/drx7mhstkyrq
  http://tstorage.info/e3m7u4fe0eta
  http://tstorage.info/e57bdrxc8abq
  http://tstorage.info/ebbl9e2chtsz
  http://tstorage.info/emxrpy0x0hse
  http://tstorage.info/enc8op1d6bhq
  http://tstorage.info/ew6dlnh9ohgw
  http://tstorage.info/f3nj2ktevek6
  http://tstorage.info/f6enpwoxqw1x
  http://tstorage.info/fworpaqw43nc
  http://tstorage.info/g4xun3t2ao7s
  http://tstorage.info/gc3q5na2m5yk
  http://tstorage.info/gdhvy1eew4fl
  http://tstorage.info/gimonz8m55rh
  http://tstorage.info/gja0c7v6lklu
  http://tstorage.info/gpg18vyqkvwo
  http://tstorage.info/gqh55nkz338g
  http://tstorage.info/h6hl376hd06j
  http://tstorage.info/hb9ld85umyoc
  http://tstorage.info/hcognd27j8uv
  http://tstorage.info/hisarpsn6arl
  http://tstorage.info/hkfvl3lrzgmz
  http://tstorage.info/hv2f93smyvwv
  http://tstorage.info/hwgr652qr8yh
  http://tstorage.info/hwxje8azabiw
  http://tstorage.info/i1bqt5wpvpaz
  http://tstorage.info/i3eqnpmm0znq
  http://tstorage.info/i6v3a4hi1hl1
  http://tstorage.info/ia15wiahpxhp
  http://tstorage.info/ia1o4etpw28c
  http://tstorage.info/iqv9srihghm7
  http://tstorage.info/j5ywfzenyr2y
  http://tstorage.info/jbdv52hky0zh
  http://tstorage.info/jht9iy74ohx6
  http://tstorage.info/jrxv0rjk15uy
  http://tstorage.info/jtum9duyxij8
  http://tstorage.info/jw9fbwlrfu7w
  http://tstorage.info/jyxes98fswr9
  http://tstorage.info/k4l5qppg0vn5
  http://tstorage.info/k7w9ai3wrazb
  http://tstorage.info/kbcl5knqvolc
  http://tstorage.info/kd3upelnym46
  http://tstorage.info/kryf2zj14n7z
  http://tstorage.info/lgc6zld91x9p
  http://tstorage.info/liepkjuu2uh9
  http://tstorage.info/ll5ib6nyexng
  http://tstorage.info/lm25pv1p8rmw
  http://tstorage.info/lmdxiwdjbmvi
  http://tstorage.info/lomwgd3ik0nq
  http://tstorage.info/lt6nz2ggtql8
  http://tstorage.info/lywfx3vec6hd
  http://tstorage.info/m3swnhbe9u9d
  http://tstorage.info/m9609dirsezw
  http://tstorage.info/ml3stnrmxupt
  http://tstorage.info/mll5aqilg4cu
  http://tstorage.info/mnwobdm3wo04
  http://tstorage.info/ni8ulagiecpz
  http://tstorage.info/nj3bm5jxibv3
  http://tstorage.info/nmybi4cf9mgz
  http://tstorage.info/nry2psws5hen
  http://tstorage.info/nxqe3etlb69h
  http://tstorage.info/ny6pvmb8wj0c
  http://tstorage.info/o4pyj17cacmt
  http://tstorage.info/o7f847ncmxl4
  http://tstorage.info/o8euzm7ie89z
  http://tstorage.info/otib8lnwxjsc
  http://tstorage.info/p72r5bre1sgh
  http://tstorage.info/pesc6whu68yh
  http://tstorage.info/pn71vq81mu2e
  http://tstorage.info/psdzz2bdxje2
  http://tstorage.info/pt9z904pefcq
  http://tstorage.info/q4ak7f3ixkto
  http://tstorage.info/q5fobp8h5df2
  http://tstorage.info/qag3vtduk6ey
  http://tstorage.info/qgvjpbtqu2v0
  http://tstorage.info/qlyf17v1zljw
  http://tstorage.info/qoj7s2mj3x1l
  http://tstorage.info/qq6nfvv30hok
  http://tstorage.info/qrjql50hd4xi
  http://tstorage.info/r95as3pd2308
  http://tstorage.info/rb3sjm8b6m13
  http://tstorage.info/rcqm1we6gg0w
  http://tstorage.info/rdca542fwecm
  http://tstorage.info/ri9e9laobk1w
  http://tstorage.info/rin3ce8mg2pz
  http://tstorage.info/rj0977puzhht
  http://tstorage.info/rpcegtdusxcr
  http://tstorage.info/rs3admvljtff
  http://tstorage.info/rvkt2lp7kudv
  http://tstorage.info/sa95a9wk83eq
  http://tstorage.info/sadcgb80e9jc
  http://tstorage.info/skc5a28zcq53
  http://tstorage.info/sl5dtni1xv9g
  http://tstorage.info/sr4u258yisfa
  http://tstorage.info/sr9klrb68yeu
  http://tstorage.info/stjm1nzryl2c
  http://tstorage.info/syowkzjp3u9q
  http://tstorage.info/t3teih8txmtd
  http://tstorage.info/t8hr813fvqe4
  http://tstorage.info/tcnicn9dhlbc
  http://tstorage.info/tq27xlee2pur
  http://tstorage.info/tq4ycx4nxpf0
  http://tstorage.info/tq6ccegzaqww
  http://tstorage.info/u6gkiuqf5rzi
  http://tstorage.info/u8t17z0o7uxm
  http://tstorage.info/u8t7zo7uxm
  http://tstorage.info/uapgfnexcgg3
  http://tstorage.info/uelxpq0jt9pt
  http://tstorage.info/ujfci97n8etr
  http://tstorage.info/ul2h61096mb6
  http://tstorage.info/ul4hepuis7pr
  http://tstorage.info/uux81kao1svj
  http://tstorage.info/uzyr12zurl03
  http://tstorage.info/v9v504jh3ryp
  http://tstorage.info/vdpk2voylih1
  http://tstorage.info/vfcaypxcbxrq
  http://tstorage.info/vh58ro3qe51s
  http://tstorage.info/vnrds7j30egd
  http://tstorage.info/vny3gz8zawvp
  http://tstorage.info/w5vdqqfa06pl
  http://tstorage.info/wk0ptu4ka3vx
  http://tstorage.info/wszx8rxfxlz8
  http://tstorage.info/wufscc97ynf7
  http://tstorage.info/wx714i45wb42
  http://tstorage.info/x31ig2r8hhpc
  http://tstorage.info/x62wpv3uvtwp
  http://tstorage.info/xeyi4h43kyrv
  http://tstorage.info/xfc2g0qml665
  http://tstorage.info/xgw8554uh44d
  http://tstorage.info/xilm9e8y8us7
  http://tstorage.info/xqf60qu0fsns
  http://tstorage.info/xt0ahvk8fdsv
  http://tstorage.info/xu3oiecpwxf0
  http://tstorage.info/y6ukx37wxmm2
  http://tstorage.info/y7w9ms5t3jo0
  http://tstorage.info/y871yo7ltdi2
  http://tstorage.info/yhtxfy2chrv3
  http://tstorage.info/yjhvnfupr2o1
  http://tstorage.info/yked5n1nkvqv
  http://tstorage.info/yvwpnwwc3tov
  http://tstorage.info/yzdb9lqop4gz
  http://tstorage.info/yzsav2qiwk1r
  http://tstorage.info/z5qofjlzxfre
  http://tstorage.info/z8ms8d9n5o2b
  http://tstorage.info/zhs0690wee9a
  http://tstorage.info/zr4x6p5cn6m1
]>

fetch = (i) ->
  if i >= files.length
    return console.log 'Completed'

  file = files[i]
  console.log "Downloading #file..."

  nightmare = Nightmare {-show, +center, download-response-wait: 10000, paths: downloads: "#{__dirname}/downloads"}

  nightmare
  .download-manager!
  .goto file
  .wait 'button#downloadbtn, .page-buffer'
  .wait 5000
  .evaluate -> document.querySelector('#container a[href="http://tstorage.info/premium.html"]') isnt null
  .then (is-premium-only) ->
    if is-premium-only
      console.log "#file is premium only."
      nightmare.end!then ->
        fetch i + 1
      return
    else
      nightmare
      .click 'button#downloadbtn'
      .waitDownloadsComplete!
      .end!
      .then ->
        console.log "Downloaded #file"
        fetch i + 1
  .catch (error) ->
    console.log "Skipped #file"
    console.error error
    fetch i + 1

fetch 0
